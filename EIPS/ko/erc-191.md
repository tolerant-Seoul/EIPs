---
eip: 191
title: 서명 데이터 표준
author: Martin Holst Swende, Nick Johnson
status: Final
type: Standards Track
category: ERC
created: 2016-01-20
lang: ko
original: https://github.com/ethereum/ERCs/blob/master/ERCS/erc-191.md
---

## 요약

ERC-191은 이더리움 컨트랙트 내에서 서명된 데이터를 처리하기 위한 명세를 수립하며, 사전 서명된 트랜잭션 처리의 표준화 격차를 해결합니다.

## 동기

이 명세는 다중 서명 지갑 구현에서 중요한 보안 취약점을 다룹니다:

1. **트랜잭션 혼동**: 구문적 제약 없이 표준 이더리움 트랜잭션이 사전 서명된 트랜잭션으로 잘못 해석될 수 있어 잠재적인 공격 벡터가 생성됩니다.

2. **크로스 지갑 재생 공격**: 사전 서명된 트랜잭션이 특정 검증자에 연결되지 않아 공격자가 동일한 서명자를 공유하는 다른 지갑에서 서명을 재사용할 수 있습니다.

## 명세

### 형식 구조

표준은 다음 형식을 제안합니다:

```
0x19 <버전 바이트> <버전별 데이터> <서명할 데이터>
```

선행 `0x19` 바이트는 두 가지 목적을 수행합니다:
- 서명된 데이터가 유효한 RLP 인코딩이 될 수 없도록 보장 (단일 바이트 0x00-0x7f는 RLP에서 자체 인코딩됨)
- 이 접두사를 사용하는 기존 `personal_sign` 구현과의 호환성 유지

### 버전 레지스트리

| 버전 | 참조 | 목적 |
|------|------|------|
| `0x00` | EIP-191 | 의도된 검증자 주소가 포함된 데이터 |
| `0x01` | EIP-712 | 구조화된 데이터 서명 |
| `0x45` | EIP-191 | 개인 서명 메시지 |

### 버전 상세

#### 버전 `0x00`: 의도된 검증자가 있는 데이터

메시지 해시에 검증자 주소를 포함하여 다른 컨트랙트에서 무단 재사용을 방지합니다. 이는 서명을 특정 컨트랙트 인스턴스에 "연결"합니다.

```
0x19 <0x00> <검증자 주소> <데이터>
```

#### 버전 `0x01`: 구조화된 데이터 (EIP-712)

EIP-712 구조화된 데이터 서명과 함께 사용됩니다.

```
0x19 <0x01> <도메인 분리자> <타입 해시> <데이터>
```

#### 버전 `0x45`: 개인 메시지 (`personal_sign`)

레거시 개인 서명을 위한 접두사 메시지 형식을 수용합니다.

```
0x19 <0x45> "thereum Signed Message:\n" <메시지 길이> <메시지>
```

(0x45는 ASCII 'E'이며, 결과적으로 "\x19Ethereum Signed Message:\n"이 됩니다)

### 구현 예시

Solidity 예시는 프로토콜 마커, 버전 바이트, 검증자 주소 및 애플리케이션별 매개변수를 해싱하여 복구 가능한 서명을 생성하는 방법을 보여줍니다.

```solidity
function signatureBasedExecution(
    address target,
    uint256 nonce,
    bytes memory payload,
    uint8 v,
    bytes32 r,
    bytes32 s
) public payable {
    // 검증자 주소로 서명자 복구
    bytes32 hash = keccak256(
        abi.encodePacked(
            byte(0x19),
            byte(0x00),
            address(this),  // 검증자 주소
            target,
            msg.value,
            nonce,
            payload
        )
    );

    address signer = ecrecover(hash, v, r, s);
    require(signer == authorizedSigner, "Invalid signature");

    // 실행 로직...
}
```

## 보안 고려사항

### 재생 공격 방지

- 버전 `0x00`은 검증자 주소를 포함하여 크로스 컨트랙트 재생을 방지
- 논스를 포함하여 동일 컨트랙트 내 재생 방지
- 체인 ID를 포함하여 크로스 체인 재생 방지 (EIP-712에서 다룸)

### 트랜잭션 혼동 방지

`0x19` 접두사는 서명된 데이터가 유효한 이더리움 트랜잭션과 구별되도록 보장합니다.

## 역호환성

이 명세는 기존 표준에 영향을 주지 않으며 현재 이더리움 인프라 위에서 구축할 수 있습니다.

## 관련 표준

- **EIP-712**: 구조화된 데이터 해싱 및 서명 - ERC-191의 버전 `0x01`을 사용
- **EIP-1271**: 스마트 컨트랙트를 위한 표준 서명 검증 방법

## 저작권

저작권 및 관련 권리는 CC0를 통해 포기되었습니다.
